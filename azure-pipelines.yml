trigger:
- main

pool:
  vmImage: 'ubuntu-latest'

steps:
- task: NodeTool@0
  inputs:
    versionSpec: '18.x'
  displayName: 'Install Node.js'

# Install dependencies inside demo-app folder
- script: npm install
  workingDirectory: demo-app
  displayName: 'Install Dependencies'

# Build React app inside demo-app folder
- script: npm run build
  workingDirectory: demo-app
  displayName: 'Build React App'

# Publish the build artifacts
- task: PublishBuildArtifacts@1
  inputs:
    PathtoPublish: 'demo-app/build'
    ArtifactName: 'drop'
    
# Deploy to Azure Static Web App
- task: AzureStaticWebApp@0
  inputs:
    app_location: 'drop'
    azure_static_web_apps_api_token: 'c7b3e3aadf5394574d91eaf3338ad5b7fbaa7193d1936a697f0ac3a2531f798503-15211cb1-6046-41f4-a265-5d1f1a4572f4010152300f41b310'